name: Vehicles
path: /vehicles

routes:
- upstream: /
  method: GET
  use: downstream
  downstream: vehicles-service/vehicles
  auth: true
  on_success:
    data: response.data.items

- upstream: /{vehicleId}
  method: GET
  use: downstream
  downstream: vehicles-service/vehicles/{vehicleId}
  auth: true

- upstream: /
  method: POST
  auth: true
  resource_id:
    property: vehicleId
    generate: true
  use: message_broker
  config:
    exchange: vehicles
    routing_key: vehicles.add_vehicle

- upstream: /{vehicleId}
  method: PUT
  auth: true
  use: message_broker
  config:
    exchange: vehicles
    routing_key: vehicles.update_vehicle
  bind:
    - vehicleId:{vehicleId}

- upstream: /{vehicleId}
  method: DELETE
  auth: true
  use: message_broker
  config:
    exchange: vehicles
    routing_key: vehicles.delete_vehicle
  bind:
    - vehicleId:{vehicleId}
  
services:
  vehicles-service:
    local_url: localhost:5009
    url: load_balancer/vehicles-service